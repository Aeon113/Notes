# 2024-03-30

## 1. 进程和线程的区别

进程是资源分配的基本单位，线程是cpu调度的基本单位。

一个进程可以包含有多个线程。

进程间切换的效率要低于线程间切换。

业务采用多进程，健壮性要强于多线程的模式。

## 2. 系统调用是否会引起线程切换

有可能

## 3. TCP和UDP的区别

1. TCP是面向连接的, 它需要建链、断链操作，它的数据传输是点对点的。而UDP则无需建链和断链，它可以一对多或多对一的发送数据。
2. TCP的应用层接收和发送的是字节流，UDP收发的是报文。
3. TCP是可靠传输，UDP不是可靠传输。TCP利用序列号，滑动窗口，拥塞控制，重传机制等来保证可靠传输，而UDP不会确认数据是否被成功接收，也没用重传等机制和拥塞控制，也不保证接收顺序。
4. TCP的传输效率低，而UDP的传输效率高。因为可靠传输需要牺牲传输效率；另外TCP的协议头要大于UDP，因此发送同样量的数据，TCP需要更大的流量。
5. 通常TCP被用在对可靠性要求高的场景，UDP用在对实时性要求高的场景。

## 4. 其它TCP相关

1. 为什么TCP需要序列号: 因为应用层收发的是字节流，而字节流需要保序。数据在网络传输的过程中，可能出现报文拆分和丢包；接收端收到数据的顺序也可能不同于发送端的发送顺序。同时发送端也可能进行重传的行为。而且TCP的可靠传输还需要接收端返回ack序列号标记来进行确认应答。
2. 为什么每次TCP建链都需要随机选取序列号: 防止两端之间的历史连接上的数据包影响本连接。
3. 滑动窗口机制的目的: 流量控制，通过增加或减少滑动窗口的大小来增加或减少发送流量；保证可靠传输，通过发送窗口，和接收方返回的ack序列号，发送方可以确认哪些数据已被对端成功接收，哪些数据需要重新发送。

## 5. TCP如何保证可靠性

依赖重传机制，滑动窗口，流量控制和拥塞控制。

1. 重传机制：首先，TCP依赖序列号和序列应答来判断对端是否成功收到了数据。然后，触发重传的方式主要有2种，一种是超时重传，如果一段时间内没有收到来自对端的相应的ack信息，则开始重传；另一种是快重传，如果在超时定时器触发前，收到了对端的3次相同的ack序列号，则从此ack对应的字节开始重传。

> 一种TCP的拓展是SACK。当接收端收到一个乱序的数据包时，它会在ACK包的选项字段中添加一个SACK选项，这个选项包含了接收端已经接收到的非连续数据段的起始和结束序列号。这样，发送端就可以知道哪些数据包已经被接收，哪些数据包需要重传。
>
> DSACK: 这是一种在SACK基础上的拓展。当接收端收到一个重复的数据包时，它会在ACK包的选项字段中添加一个DSACK选项，这个选项包含了接收端收到的重复数据段的起始和结束序列号。这样，发送端就可以知道哪些数据包被错误地重传了。
>

2. 滑动窗口: 决定了在未收到应答的情况下，发送方可以发送多少数据。

> 窗口通常在三次握手时就决定了初始值。通常两端各有一个接收滑动窗口和一个发送滑动窗口。

3. 流量控制: 接收方通过控制接收的数据量，来限制发送方的数据发送量，避免产生丢包。具体方法是先收缩接收滑动窗口，再减少接收缓冲区。
4. 拥塞控制: 慢启动等，具体有多种不同的拥塞控制算法。·
